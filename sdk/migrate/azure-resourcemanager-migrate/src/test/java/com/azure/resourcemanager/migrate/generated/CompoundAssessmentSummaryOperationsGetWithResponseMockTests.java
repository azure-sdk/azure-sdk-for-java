// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) TypeSpec Code Generator.

package com.azure.resourcemanager.migrate.generated;

import com.azure.core.credential.AccessToken;
import com.azure.core.http.HttpClient;
import com.azure.core.management.profile.AzureProfile;
import com.azure.core.models.AzureCloud;
import com.azure.core.test.http.MockHttpResponse;
import com.azure.resourcemanager.migrate.MigrateManager;
import com.azure.resourcemanager.migrate.models.WebAppCompoundAssessmentSummary;
import com.azure.resourcemanager.migrate.models.WebAppType;
import com.azure.resourcemanager.migrate.models.WebServerType;
import java.nio.charset.StandardCharsets;
import java.time.OffsetDateTime;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import reactor.core.publisher.Mono;

public final class CompoundAssessmentSummaryOperationsGetWithResponseMockTests {
    @Test
    public void testGetWithResponse() throws Exception {
        String responseStr
            = "{\"properties\":{\"summaryType\":\"Unknown\",\"summaryName\":\"wwzjuqkhrsajiwku\",\"sources\":[{\"sourceName\":\"SqlDatabase\",\"sourceType\":\"Instance\",\"platform\":\"Unknown\",\"count\":1707713789}],\"targets\":[{\"targetName\":\"AzureSQLVM\",\"targetType\":\"ManagementServer\",\"platform\":\"PaaS\",\"count\":825029486},{\"targetName\":\"AzureVM\",\"targetType\":\"Database\",\"platform\":\"IaaS\",\"count\":1166674819},{\"targetName\":\"Avs\",\"targetType\":\"WebApplication\",\"platform\":\"SaaS\",\"count\":28529322},{\"targetName\":\"AzureAppService\",\"targetType\":\"Server\",\"platform\":\"IaaS\",\"count\":699840472}],\"targetSourceMapping\":[{\"sourceRef\":\"MySQLServer\",\"targetRef\":\"AzureSQLVM\",\"sourceCount\":1118484246,\"targetCount\":2071928441,\"migrationDetails\":{\"readinessSummary\":[{},{}],\"migrationType\":\"Rearchitect\"},\"managementDetails\":[{},{},{},{}],\"costDetails\":[{},{},{}],\"savingsDetails\":[{},{},{},{}],\"confidenceScore\":51.23474953895448},{\"sourceRef\":\"OracleDatabase\",\"targetRef\":\"AzureSpringApps\",\"sourceCount\":943693980,\"targetCount\":517393984,\"migrationDetails\":{\"readinessSummary\":[{},{}],\"migrationType\":\"Unknown\"},\"managementDetails\":[{},{}],\"costDetails\":[{},{},{},{}],\"savingsDetails\":[{},{},{}],\"confidenceScore\":83.60561918791308},{\"sourceRef\":\"SpringbootApplication\",\"targetRef\":\"AzureAppService\",\"sourceCount\":852408036,\"targetCount\":1533389693,\"migrationDetails\":{\"readinessSummary\":[{},{},{},{}],\"migrationType\":\"Retain\"},\"managementDetails\":[{},{}],\"costDetails\":[{},{},{}],\"savingsDetails\":[{},{}],\"confidenceScore\":22.211011404638537}],\"costComponents\":[{\"savingOptions\":\"RI1Year\",\"costDetail\":[{},{},{},{}]},{\"savingOptions\":\"SavingsPlan3Year\",\"costDetail\":[{}]},{\"savingOptions\":\"None\",\"costDetail\":[{},{},{},{}]}],\"savingsComponents\":[{\"savingOptions\":\"None\",\"savingsDetail\":[{},{},{}]},{\"savingOptions\":\"None\",\"savingsDetail\":[{}]},{\"savingOptions\":\"SavingsPlan1Year\",\"savingsDetail\":[{},{},{},{}]},{\"savingOptions\":\"None\",\"savingsDetail\":[{},{},{}]}],\"assessmentName\":\"z\",\"discoveredLightSummary\":{\"numberOfWebApps\":212177726,\"numberOfWebAppsPerType\":[{\"webAppType\":\"Java\",\"count\":862594448},{\"webAppType\":\"ASP.Net\",\"count\":157234884},{\"webAppType\":\"Java\",\"count\":642461794},{\"webAppType\":\"ASP.Net\",\"count\":244069221}],\"numberOfWebServersPerType\":[{\"webServerType\":\"Tomcat\",\"count\":2112033193},{\"webServerType\":\"IIS\",\"count\":2000492920}],\"numberOfWebServers\":1701243846,\"numberOfServers\":2009239525}},\"id\":\"typmrbpizcdrqjsd\",\"name\":\"ydnfyhxdeoejz\",\"type\":\"cwif\"}";

        HttpClient httpClient
            = response -> Mono.just(new MockHttpResponse(response, 200, responseStr.getBytes(StandardCharsets.UTF_8)));
        MigrateManager manager = MigrateManager.configure()
            .withHttpClient(httpClient)
            .authenticate(tokenRequestContext -> Mono.just(new AccessToken("this_is_a_token", OffsetDateTime.MAX)),
                new AzureProfile("", "", AzureCloud.AZURE_PUBLIC_CLOUD));

        WebAppCompoundAssessmentSummary response = manager.compoundAssessmentSummaryOperations()
            .getWithResponse("xxbczwtr", "wiqzbqjvsovmyo", "acspkwl", "zdobpxjmflbvvnch",
                com.azure.core.util.Context.NONE)
            .getValue();

        Assertions.assertEquals("z", response.properties().assessmentName());
        Assertions.assertEquals(212177726, response.properties().discoveredLightSummary().numberOfWebApps());
        Assertions.assertEquals(WebAppType.JAVA,
            response.properties().discoveredLightSummary().numberOfWebAppsPerType().get(0).webAppType());
        Assertions.assertEquals(862594448,
            response.properties().discoveredLightSummary().numberOfWebAppsPerType().get(0).count());
        Assertions.assertEquals(WebServerType.TOMCAT,
            response.properties().discoveredLightSummary().numberOfWebServersPerType().get(0).webServerType());
        Assertions.assertEquals(2112033193,
            response.properties().discoveredLightSummary().numberOfWebServersPerType().get(0).count());
        Assertions.assertEquals(1701243846, response.properties().discoveredLightSummary().numberOfWebServers());
        Assertions.assertEquals(2009239525, response.properties().discoveredLightSummary().numberOfServers());
    }
}
