// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.network.generated.generated;

import com.azure.core.management.serializer.SerializerFactory;
import com.azure.core.util.serializer.SerializerEncoding;
import com.azure.resourcemanager.network.generated.models.FlowLogInformationRequest;
import com.azure.resourcemanager.network.generated.models.RequestIdentityObjectForUserAssigned;
import com.azure.resourcemanager.network.generated.models.ResourceIdentityType;
import java.io.IOException;

/** Samples for NetworkWatchers SetFlowLogConfiguration. */
public final class NetworkWatchersSetFlowLogConfigurationSamples {
    /*
     * x-ms-original-file: specification/network/resource-manager/Microsoft.Network/stable/2023-05-01/examples/NetworkWatcherFlowLogConfigure.json
     */
    /**
     * Sample code: Configure flow log.
     *
     * @param manager Entry point to NetworkManager.
     */
    public static void configureFlowLog(com.azure.resourcemanager.network.generated.NetworkManager manager)
        throws IOException {
        manager
            .networkWatchers()
            .setFlowLogConfiguration(
                "rg1",
                "nw1",
                new FlowLogInformationRequest()
                    .withTargetResourceId(
                        "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Network/networkSecurityGroups/nsg1")
                    .withIdentity(
                        new RequestIdentityObjectForUserAssigned()
                            .withType(ResourceIdentityType.USER_ASSIGNED)
                            .withUserAssignedIdentities(
                                SerializerFactory
                                    .createDefaultManagementSerializerAdapter()
                                    .deserialize(
                                        "{\"/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id1\":{},\"/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.ManagedIdentity/userAssignedIdentities/id2\":{}}",
                                        Object.class,
                                        SerializerEncoding.JSON)))
                    .withStorageId(
                        "/subscriptions/subid/resourceGroups/rg1/providers/Microsoft.Storage/storageAccounts/st1")
                    .withEnabled(true),
                com.azure.core.util.Context.NONE);
    }
}
