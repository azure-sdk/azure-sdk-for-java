// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.resourcemanager.securityinsights.models.IncidentCreationPropertyConditionProperties;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRuleGroupingAttribute;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRulePropertyBasedGroupingProperties;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRulePropertyConditionProperties;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRulePropertyConditionSupportedOperator;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRulePropertyConditionSupportedProperty;
import com.azure.resourcemanager.securityinsights.models.IncidentCreationRulePropertyGroupingSupportedProperty;
import com.azure.resourcemanager.securityinsights.models.PropertyBasedGroupingProperties;
import java.time.Duration;
import java.util.Arrays;

/** Samples for IncidentCreationRules CreateOrUpdate. */
public final class IncidentCreationRulesCreateOrUpdateSamples {
    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2023-08-01-preview/examples/incidentCreationRules/IncidentCreationRules_CreateOrUpdate.json
     */
    /**
     * Sample code: IncidentCreationRules_CreateOrUpdate.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void incidentCreationRulesCreateOrUpdate(
        com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager) {
        manager
            .incidentCreationRules()
            .define("73e01a99-5cd7-4139-a149-9f2736ff2ab5")
            .withExistingWorkspace("myRg", "myWorkspace")
            .withDisplayName("My incident creation rule")
            .withOrder(1)
            .withCreateIncident(true)
            .withEnabled(true)
            .withEtag("\"0300bf09-0000-0000-0000-5c37296e0000\"")
            .withDescription("This is a demo incident creation rule")
            .withConditions(
                Arrays
                    .asList(
                        new IncidentCreationPropertyConditionProperties()
                            .withConditionProperties(
                                new IncidentCreationRulePropertyConditionProperties()
                                    .withPropertyName(
                                        IncidentCreationRulePropertyConditionSupportedProperty.ALERT_ANALYTIC_RULE_ID)
                                    .withOperator(IncidentCreationRulePropertyConditionSupportedOperator.CONTAINS)
                                    .withPropertyValues(
                                        Arrays
                                            .asList(
                                                "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRules/fab3d2d4-747f-46a7-8ef0-9c0be8112bf7",
                                                "/subscriptions/d0cfe6b2-9ac0-4464-9919-dccaee2e48c0/resourceGroups/myRg/providers/Microsoft.OperationalInsights/workspaces/myWorkspace/providers/Microsoft.SecurityInsights/alertRules/8deb8303-e94d-46ff-96e0-5fd94b33df1a")))))
            .withGroupingConfiguration(
                new PropertyBasedGroupingProperties()
                    .withEnabled(true)
                    .withLookbackDuration(Duration.parse("PT5H"))
                    .withReopenClosedIncident(false)
                    .withGroupingProperties(
                        new IncidentCreationRulePropertyBasedGroupingProperties()
                            .withGroupingAttributes(
                                Arrays
                                    .asList(
                                        new IncidentCreationRuleGroupingAttribute()
                                            .withPropertyName(
                                                IncidentCreationRulePropertyGroupingSupportedProperty.ALERT_PROPERTIES)
                                            .withPropertyValue("Severity"),
                                        new IncidentCreationRuleGroupingAttribute()
                                            .withPropertyName(
                                                IncidentCreationRulePropertyGroupingSupportedProperty.ALERT_PROPERTIES)
                                            .withPropertyValue("DisplayName")))))
            .create();
    }
}
