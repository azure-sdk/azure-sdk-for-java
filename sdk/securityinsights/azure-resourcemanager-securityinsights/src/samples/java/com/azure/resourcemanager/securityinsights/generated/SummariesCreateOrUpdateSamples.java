// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

/** Samples for Summaries CreateOrUpdate. */
public final class SummariesCreateOrUpdateSamples {
    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2023-03-01-preview/examples/dynamicSummaries/CreateSummaryAndSummaryItems.json
     */
    /**
     * Sample code: Creates or updates a summary and bulk creates summary items.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void createsOrUpdatesASummaryAndBulkCreatesSummaryItems(
        com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager) {
        manager
            .summaries()
            .define("d0cfe6b2-9ac0-4464-9919-dccae00000012")
            .withExistingWorkspace("myRg", "myWorkspace")
            .withEtag("\"0300bf09-0000-0000-0000-5c37296e0000\"")
            .withSummaryName("SignedIn users")
            .withSearchKey("header1")
            .withTactics(Arrays.asList())
            .withTechniques(Arrays.asList())
            .withRelationName("huntSession")
            .withRelationId("abc123")
            .withSummaryDescription("List of users signed in in 30 days")
            .withRawContent(
                "[{ \"EventTimeUtc\": \"2022-04-25T14:22:08Z\", \"ObservableType\": \"IP\", \"ObservableValue\":"
                    + " \"SomeIp\", \"RelationId\" : \"Some Relation1\", \"SearchKey\" : \"Some sear\","
                    + " \"PackedContent\" : {\"SomeKey\" : \"SomeValue\"} } , { \"EventTimeUtc\":"
                    + " \"2022-04-26T14:22:08Z\", \"ObservableType\": \"IP\", \"ObservableValue\": \"SomeIp2\","
                    + " \"RelationId\" : \"Some Relation2\", \"SearchKey\" : \"Some searchKey\", \"PackedContent\" :"
                    + " {\"SomeKey\" : \"SomeValue2\"} }]")
            .create();
    }

    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2023-03-01-preview/examples/dynamicSummaries/CreateSummary.json
     */
    /**
     * Sample code: Creates or updates a Summary.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void createsOrUpdatesASummary(
        com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager) {
        manager
            .summaries()
            .define("d0cfe6b2-9ac0-4464-9919-dccae00000012")
            .withExistingWorkspace("myRg", "myWorkspace")
            .withEtag("\"0300bf09-0000-0000-0000-5c37296e0000\"")
            .withSummaryName("SignedIn users")
            .withSourceInfo(mapOf("name", "Cred Scan", "source", "notebook", "version", "1.0.0.0"))
            .withSearchKey("header1")
            .withTactics(Arrays.asList())
            .withTechniques(Arrays.asList())
            .withRelationName("huntSession")
            .withRelationId("abc123")
            .withSummaryDescription("List of users signed in in 30 days")
            .create();
    }

    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
