// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.util.Context;
import com.azure.resourcemanager.securityinsights.models.Clause;
import com.azure.resourcemanager.securityinsights.models.Condition;
import com.azure.resourcemanager.securityinsights.models.ConditionOperator;
import com.azure.resourcemanager.securityinsights.models.Connective;
import com.azure.resourcemanager.securityinsights.models.ThreatIntelligenceCountByCondition;
import java.util.Arrays;

/** Samples for ThreatIntelligenceIndicator CountFromCondition. */
public final class ThreatIntelligenceIndicatorCountFromConditionSamples {
    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2022-10-01-preview/examples/threatintelligence/CountThreatIntelligenceByCondition.json
     */
    /**
     * Sample code: Count Indicators from condition.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void countIndicatorsFromCondition(
        com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager) {
        manager
            .threatIntelligenceIndicators()
            .countFromConditionWithResponse(
                "myRg",
                "myWorkspace",
                new ThreatIntelligenceCountByCondition()
                    .withCondition(
                        new Condition()
                            .withConditionConnective(Connective.AND)
                            .withClauses(
                                Arrays
                                    .asList(
                                        new Clause()
                                            .withField("source")
                                            .withOperator(ConditionOperator.EQUAL)
                                            .withValues(Arrays.asList("source1")),
                                        new Clause()
                                            .withClauseConnective(Connective.OR)
                                            .withField("confidence")
                                            .withOperator(ConditionOperator.GREATER_THAN)
                                            .withValues(Arrays.asList("50"))))),
                Context.NONE);
    }
}
