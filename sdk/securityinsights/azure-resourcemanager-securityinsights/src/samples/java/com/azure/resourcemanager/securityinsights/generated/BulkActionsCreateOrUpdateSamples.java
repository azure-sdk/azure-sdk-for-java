// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.resourcemanager.securityinsights.models.Clause;
import com.azure.resourcemanager.securityinsights.models.Condition;
import com.azure.resourcemanager.securityinsights.models.ConditionOperator;
import com.azure.resourcemanager.securityinsights.models.Connective;
import com.azure.resourcemanager.securityinsights.models.Operation;
import com.azure.resourcemanager.securityinsights.models.OperationMutator;
import com.azure.resourcemanager.securityinsights.models.OperationStep;
import com.azure.resourcemanager.securityinsights.models.OperationType;
import com.azure.resourcemanager.securityinsights.models.TargetType;
import java.util.Arrays;

/** Samples for BulkActions CreateOrUpdate. */
public final class BulkActionsCreateOrUpdateSamples {
    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2022-10-01-preview/examples/bulkActions/CreateBulkAction.json
     */
    /**
     * Sample code: Create a bulk action.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void createABulkAction(com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager) {
        manager
            .bulkActions()
            .define("73e01a99-5cd7-4139-a149-9f2736ff2ab5")
            .withExistingWorkspace("myRg", "myWorkspace")
            .withTargetType(TargetType.STIX_INDICATOR)
            .withCondition(
                new Condition()
                    .withConditionConnective(Connective.AND)
                    .withClauses(
                        Arrays
                            .asList(
                                new Clause()
                                    .withField("source")
                                    .withOperator(ConditionOperator.EQUAL)
                                    .withValues(Arrays.asList("source1")),
                                new Clause()
                                    .withClauseConnective(Connective.OR)
                                    .withField("confidence")
                                    .withOperator(ConditionOperator.GREATER_THAN)
                                    .withValues(Arrays.asList("50")))))
            .withOperation(
                new Operation()
                    .withType(OperationType.EDIT)
                    .withSteps(
                        Arrays
                            .asList(
                                new OperationStep()
                                    .withField("confidence")
                                    .withMutator(OperationMutator.SET_VALUE)
                                    .withValue("99"))))
            .withExecutionOrder(1)
            .create();
    }
}
