// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.securityinsights.generated;

import com.azure.core.management.serializer.SerializerFactory;
import com.azure.core.util.serializer.SerializerEncoding;
import com.azure.resourcemanager.securityinsights.models.Kind;
import com.azure.resourcemanager.securityinsights.models.MetadataAuthor;
import com.azure.resourcemanager.securityinsights.models.MetadataSource;
import com.azure.resourcemanager.securityinsights.models.MetadataSupport;
import com.azure.resourcemanager.securityinsights.models.PackageKind;
import com.azure.resourcemanager.securityinsights.models.SourceKind;
import com.azure.resourcemanager.securityinsights.models.SupportTier;
import java.io.IOException;

/** Samples for ContentTemplateOperation Install. */
public final class ContentTemplateOperationInstallSamples {
    /*
     * x-ms-original-file: specification/securityinsights/resource-manager/Microsoft.SecurityInsights/preview/2023-06-01-preview/examples/contentTemplates/InstallTemplate.json
     */
    /**
     * Sample code: Get a template.
     *
     * @param manager Entry point to SecurityInsightsManager.
     */
    public static void getATemplate(com.azure.resourcemanager.securityinsights.SecurityInsightsManager manager)
        throws IOException {
        manager
            .contentTemplateOperations()
            .define("str.azure-sentinel-solution-str")
            .withExistingWorkspace("myRg", "myWorkspace")
            .withContentId("8365ebfe-a381-45b7-ad08-7d818070e11f")
            .withVersion("1.0.1")
            .withDisplayName("API Protection workbook template")
            .withContentKind(Kind.ANALYTICS_RULE)
            .withSource(
                new MetadataSource()
                    .withKind(SourceKind.SOLUTION)
                    .withName("str")
                    .withSourceId("str.azure-sentinel-solution-str"))
            .withAuthor(new MetadataAuthor().withName("Microsoft").withEmail("support@microsoft.com"))
            .withSupport(
                new MetadataSupport()
                    .withTier(SupportTier.MICROSOFT)
                    .withName("Microsoft Corporation")
                    .withEmail("support@microsoft.com")
                    .withLink("https://support.microsoft.com/"))
            .withPackageId("str.azure-sentinel-solution-str")
            .withPackageKind(PackageKind.SOLUTION)
            .withPackageName("str")
            .withMainTemplate(
                SerializerFactory
                    .createDefaultManagementSerializerAdapter()
                    .deserialize(
                        "{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.1\",\"resources\":[{\"name\":\"8365ebfe-a381-45b7-ad08-7d818070e11f\",\"type\":\"Microsoft.SecurityInsights/AlertRuleTemplates\",\"apiVersion\":\"2022-04-01-preview\",\"kind\":\"Scheduled\",\"location\":\"[parameters('workspace-location')]\",\"properties\":{\"description\":\"Creates"
                            + " an incident when a large number of Critical/High severity CrowdStrike Falcon sensor"
                            + " detections is triggered by a single user\",\"displayName\":\"Critical or High Severity"
                            + " Detections by"
                            + " User\",\"enabled\":false,\"query\":\"...\",\"queryFrequency\":\"PT1H\",\"queryPeriod\":\"PT1H\",\"severity\":\"High\",\"status\":\"Available\",\"suppressionDuration\":\"PT1H\",\"suppressionEnabled\":false,\"triggerOperator\":\"GreaterThan\",\"triggerThreshold\":0}},{\"name\":\"[concat(parameters('workspace'),'/Microsoft.SecurityInsights/',concat('AnalyticsRule-',"
                            + " last(split([resourceId('Microsoft.SecurityInsights/AlertRuleTemplates',"
                            + " 8365ebfe-a381-45b7-ad08-7d818070e11f)],'/'))))]\",\"type\":\"Microsoft.OperationalInsights/workspaces/providers/metadata\",\"apiVersion\":\"2022-01-01-preview\",\"properties\":{\"description\":\"CrowdStrike"
                            + " Falcon Endpoint Protection Analytics Rule"
                            + " 1\",\"author\":{\"name\":\"Microsoft\",\"email\":\"support@microsoft.com\"},\"contentId\":\"4465ebde-b381-45f7-ad08-7d818070a11c\",\"kind\":\"AnalyticsRule\",\"parentId\":\"[resourceId('Microsoft.SecurityInsights/AlertRuleTemplates',"
                            + " 8365ebfe-a381-45b7-ad08-7d818070e11f)]\",\"source\":{\"name\":\"str\",\"kind\":\"Solution\",\"sourceId\":\"str.azure-sentinel-solution-str\"},\"support\":{\"name\":\"Microsoft"
                            + " Corporation\",\"email\":\"support@microsoft.com\",\"link\":\"https://support.microsoft.com/\",\"tier\":\"Microsoft\"},\"version\":\"1.0.0\"}}]}",
                        Object.class,
                        SerializerEncoding.JSON))
            .create();
    }
}
